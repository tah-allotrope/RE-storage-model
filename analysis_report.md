# Excel Financial Model Analysis Report

**Source File:** `AUDIT 20251201 40MW Solar ^M BESS Ecoplexus.xlsx`

**Analysis Date:** Generated by automated analyzer

---

## Executive Summary

This document maps the mathematical relationships and data flows in the Excel financial model.

### Sheets Analyzed:

- **Cover**: General Calculations
- **NAV**: General Calculations
- **Assumption**: General Calculations
- **Data Input**: Financial Returns Analysis
- **Calc**: Hourly Dispatch / Time Series Simulation
- **Helper**: General Calculations
- **Other Input**: Model Inputs / Assumptions
- **Loss**: Solar Generation Model
- **DPPA**: Hourly Dispatch / Time Series Simulation
- **Measures**: Financial Cash Flow Projection
- **Lifetime**: General Calculations
- **Financial**: General Calculations
- **Output**: Debt / Financing Schedule

---

## VBA Macros (Original Macro-Enabled File)

The original `.xlsm` file contains VBA modules that provide automation functionality. These macros are **not captured** in the `.xlsx` export but are critical for understanding the model's intended workflow.

### Module 2: Debt Sizing Solver (`Solve_Debt_Size_DSCR`)

**Purpose:** Automatically calculates optimal debt size based on Debt Service Coverage Ratio (DSCR) constraints using Excel's GoalSeek function.

```vba
Sub Solve_Debt_Size_DSCR()
    Dim ws As Worksheet
    Dim calcMode As XlCalculation
    
    Set ws = ThisWorkbook.Worksheets("Financial")
    
    ' Disable screen updating and set manual calculation for performance
    calcMode = Application.Calculation
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    Application.Calculation = xlCalculationManual
    
    ' Set initial guess from capacity-based debt size
    On Error Resume Next
    ws.Range("DebtSize_DSCR_Solver").Value = ws.Range("DebtSize_DSCR_Capacity").Value
    On Error GoTo 0
    
    ws.Calculate
    
    ' GoalSeek: Adjust DebtSize_DSCR_Solver until DebtSize_Check equals 0
    ws.Range("DebtSize_Check").GoalSeek Goal:=0, _
        ChangingCell:=ws.Range("DebtSize_DSCR_Solver")
    
CleanExit:
    Application.Calculation = calcMode
    Application.EnableEvents = True
    Application.ScreenUpdating = True
End Sub
```

**Key Named Ranges:**
- **`DebtSize_DSCR_Solver`**: The cell being adjusted (debt amount)
- **`DebtSize_DSCR_Capacity`**: Initial guess based on project capacity
- **`DebtSize_Check`**: Validation cell that should equal 0 when DSCR constraint is satisfied

**Financial Logic:** This macro implements iterative debt sculpting to find the maximum debt that satisfies DSCR covenants. The GoalSeek varies the debt size until the check cell (likely `Min DSCR - Target DSCR`) equals zero.

---

### Module 3: Navigation Utilities

**Purpose:** UI helper macros for navigating between sheets and resetting views.

#### `Nav_Click()` - Sheet Navigation
```vba
Public Sub Nav_Click()
    Dim shp As Shape
    Dim SheetName As String
    Dim ws As Worksheet
    Dim prevVis As XlSheetVisibility
    
    On Error GoTo ErrHandler
    Set shp = ActiveSheet.Shapes(Application.Caller)
    SheetName = shp.Name
    Set ws = ThisWorkbook.Worksheets(SheetName)
    prevVis = ws.Visible
    
    ' Make hidden sheets visible temporarily
    If prevVis <> xlSheetVisible Then
        ws.Visible = xlSheetVisible
        gTempSheetName = ws.Name
        gTempSheetPrevVisible = prevVis
    Else
        gTempSheetName = ""
    End If
    
    ' Navigate to sheet and reset view
    ws.Activate
    ws.Range("A1").Select
    ActiveWindow.Zoom = 100
    With ActiveWindow
        .ScrollRow = 1
        .ScrollColumn = 1
    End With
    Exit Sub

ErrHandler:
    MsgBox "Navigation Error: " & Err.Description, vbCritical
End Sub
```

#### `Reset_All_Sheets_View()` - View Reset
```vba
Public Sub Reset_All_Sheets_View()
    Dim ws As Worksheet
    Dim prevSheet As Worksheet
    
    On Error Resume Next
    Set prevSheet = ActiveSheet
    On Error GoTo 0
    
    For Each ws In ThisWorkbook.Worksheets
        If ws.Visible = xlSheetVisible Then
            ws.Activate
            ws.Range("A1").Select
            With ActiveWindow
                .ScrollRow = 1
                .ScrollColumn = 1
            End With
            ' Different zoom levels for different sheets
            Select Case ws.Name
                Case "Cover", "NAV"
                    ActiveWindow.Zoom = 100
                Case Else
                    ActiveWindow.Zoom = 80
            End Select
        End If
    Next ws
    
    On Error Resume Next
    If Not prevSheet Is Nothing Then prevSheet.Activate
    On Error GoTo 0
End Sub
```

**UI Features:**
- Shape-based navigation buttons (clicking a shape named after a sheet navigates to it)
- Temporary visibility for hidden sheets
- Standardized zoom levels (100% for Cover/NAV, 80% for calculation sheets)
- Global state tracking via `gTempSheetName` and `gTempSheetPrevVisible`

---



## Sheet: Cover

### Purpose
General Calculations

**Dimensions:** 25 rows × 6 columns

### Key Inputs (Hardcoded Values)

- **Column E** (Col E): `Terms & Conditions`

### The Math (Formulas and English Translation)

No calculated columns detected in sampled rows.

### Anomalies / Flags

- **⚠️ ALLOTROPE PARTNER** (Col C): Mixed formulas (1) and hardcoded values (5) in calculation column
  - Sample formula: `=TODAY()`

---

## Sheet: NAV

### Purpose
General Calculations

**Dimensions:** 57 rows × 18 columns

### Key Inputs (Hardcoded Values)

- **Navigation** (Col B): `Navigation`
- **Sheet View Control** (Col O): `Sheet View Control`
- **Column P** (Col P): `Inputs`
- **Column R** (Col R): `Inputs style is used for cells which are meant to `

### The Math (Formulas and English Translation)

No calculated columns detected in sampled rows.

### Anomalies / Flags

No anomalies detected.

---

## Sheet: Assumption

### Purpose
General Calculations

**Dimensions:** 74 rows × 18 columns

### Key Inputs (Hardcoded Values)

- **#VALUE!** (Col B): `#VALUE!`
- **Column C** (Col C): `Simulation Capacity`
- **Saigon18** (Col D): `Saigon18`
- **Column H** (Col H): `FINANCIAL INPUT`
- **Column I** (Col I): `USD/VND`
- **Column J** (Col J): `Date`
- **Column N** (Col N): `Grid Connection`
- **Column O** (Col O): `Connection Voltage Level`
- **Column P** (Col P): `kV`

### The Math (Formulas and English Translation)

No calculated columns detected in sampled rows.

### Financial Calculations (IRR, NPV, Debt)

- **Col E**: `=SUM(SimulationData[[#All],[Irradiation_W/m2]])/1000`
  - **Result:** `2200.3632608000044`
  - **Type:** IRR Calculation
- **E10**: `=SUM(SimulationData[[#All],[Irradiation_W/m2]])/1000`
  - **Result:** `2200.3632608000044`
  - **Type:** IRR Calculation

### Anomalies / Flags

- **⚠️ Column E** (Col E): Mixed formulas (8) and hardcoded values (34) in calculation column
  - Sample formula: `=SUM(SimulationData[[#All],[Irradiation_W/m2]])/1000`
- **⚠️ Column K** (Col K): Mixed formulas (6) and hardcoded values (31) in calculation column
  - Sample formula: `=Actual_installation_capacity/1000`
- **⚠️ Column Q** (Col Q): Mixed formulas (6) and hardcoded values (29) in calculation column
  - Sample formula: `=1000*1000/Exchange_rate`

### Formatting Notes

- **Merged cell regions:** 1 found (decorative/headers)

---

## Sheet: Data Input

### Purpose
Financial Returns Analysis

**Dimensions:** 8761 rows × 6 columns

### Key Inputs (Hardcoded Values)
No significant hardcoded inputs detected.

### Time Series Data

- **DateTime** (Col A): ~8761 rows of data
- **SimulationProfile_kW** (Col B): ~8761 rows of data
- **Irradiation_W/m2** (Col C): ~8761 rows of data
- **Load_kW** (Col D): ~8761 rows of data
- **FMP** (Col E): ~8761 rows of data
- **CFMP** (Col F): ~8761 rows of data

### The Math (Formulas and English Translation)

No calculated columns detected in sampled rows.

### Anomalies / Flags

No anomalies detected.

---

## Sheet: Calc

### Purpose
Hourly Dispatch / Time Series Simulation

**Dimensions:** 8761 rows × 41 columns

### Key Inputs (Hardcoded Values)
No significant hardcoded inputs detected.

### Time Series Data

- **DateTime** (Col A): ~8761 rows of data
- **SimulationProfile_kW** (Col B): ~8761 rows of data
- **Irradiation_W/m2** (Col C): ~8761 rows of data
- **Load_kW** (Col D): ~8761 rows of data
- **TimePeriodFlag** (Col E): ~8761 rows of data
- **GridChargeAllowFlag** (Col K): ~8761 rows of data
- **DischargePower_kW** (Col V): ~8761 rows of data
- **BAU_GridEnergyExpense** (Col AC): ~8761 rows of data
- **RE_GridEnergyExpense** (Col AD): ~8761 rows of data
- **DirectPVEnergySaving** (Col AE): ~8761 rows of data
- **Solar_GridEnergyExpense** (Col AJ): ~8761 rows of data

### The Math (Formulas and English Translation)

No calculated columns detected in sampled rows.

### Anomalies / Flags

- **⚠️ SolarGen_kW** (Col F): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=IFERROR($B2 * Output_Scale_Factor, 0)`
- **⚠️ PVActive2BESS_kW** (Col G): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=_xlfn.LET(
  _xlpm.ts, $A2,
  _xlpm.hr, HOUR(_xlpm.ts)+MINUTE(_xlpm.ts)/60,
  _xlpm.isPeak, $E2="P",
  _xlpm.dt, StepHours,
  _xlpm.eta, Charge_discharge_efficiency,
  _xlpm.pv_kW, $F2,
  _xlpm.load_kW, $D2,

  _xlpm.min2Load_kW, Min_DirectPVShare * _xlpm.load_kW,
  _xlpm.cap_kW, IF(Does_BESS_System_include_?=0, 0, $P2 / _xlpm.dt),

  _xlpm.inWin1, IF(ActivePV2BESS_StartHour<=ActivePV2BESS_EndHour,
             (_xlpm.hr>=ActivePV2BESS_StartHour)*(_xlpm.hr<ActivePV2BESS_EndHour),
             OR(_xlpm.hr>=ActivePV2BESS_StartHour, _xlpm.hr<ActivePV2BESS_EndHour)),
  _xlpm.req1_kW, IF(AND(ActivePV2BESS_Mode=1, _xlpm.inWin1, NOT(_xlpm.isPeak), ActivePV2BESS_Share>0),
              _xlpm.pv_kW * ActivePV2BESS_Share, 0),

  _xlpm.gap_kWh, MAX(Precharge_TargetSoC_kWh - $M2, 0),
  _xlpm.inWin2, AND(ActivePV2BESS_Mode=2, NOT(_xlpm.isPeak), _xlpm.hr < Precharge_TargetHour),
  _xlpm.req2_kW, IF(_xlpm.inWin2, _xlpm.gap_kWh / (_xlpm.eta * _xlpm.dt), 0),

  _xlpm.req_raw_kW, _xlfn.SWITCH(ActivePV2BESS_Mode, 1, _xlpm.req1_kW, 2, _xlpm.req2_kW, 0),

  _xlpm.divertable_kW, MAX(_xlpm.pv_kW - _xlpm.min2Load_kW, 0),
  _xlpm.req_div_kW, MAX( MIN(_xlpm.req_raw_kW, _xlpm.divertable_kW), 0 ),

  MIN(_xlpm.req_div_kW, _xlpm.cap_kW)
)`
- **⚠️ NetLoadAfterSolar_kW** (Col H): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=IFERROR($F2 - $D2, 0)`
- **⚠️ DirectPVConsumption_kW** (Col I): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=MIN( $D2, MAX($F2 - $G2, 0) )`
- **⚠️ AllowDischarge** (Col J): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=IF(
  Strategy_mode=1,
  _xlfn.LET(
    _xlpm.ts,$A2,
    _xlpm.hourfrac,HOUR(_xlpm.ts)+MINUTE(_xlpm.ts)/60,
    _xlpm.isPeak, $E2="P",
    _xlpm.isSunday, WEEKDAY(_xlpm.ts,2)=7,
    _xlpm.optStart, OptimizeStartHour,
    _xlpm.optEnd,   OptimizeEndHour,
    _xlpm.condWhen, --(When_Needed=1),
    _xlpm.condAfter,--(AND(After_Sunset=1, _xlpm.hourfrac>17)),
    _xlpm.condOpt,  --(AND(Optimize_mode_1=1, OR(AND(_xlpm.hourfrac>=_xlpm.optStart,_xlpm.hourfrac<_xlpm.optEnd), _xlpm.isPeak, AND(_xlpm.isSunday, _xlpm.hourfrac>15, _xlpm.hourfrac<=20)))),
    _xlpm.condPeak, --(AND(Peak=1, OR(_xlpm.isPeak, AND(_xlpm.isSunday, OR(AND(_xlpm.hourfrac>4, _xlpm.hourfrac<9), AND(_xlpm.hourfrac>16, _xlpm.hourfrac<=20)))))),
    IF(_xlpm.condWhen+_xlpm.condAfter+_xlpm.condOpt+_xlpm.condPeak>0,1,0)
  ),
  _xlfn.LET(
    _xlpm.demandTarget_kW, $AK2,
    _xlpm.grid_kW,         $AI2,
    IF(_xlpm.grid_kW > _xlpm.demandTarget_kW, 1, 0)
  )
)`
- **⚠️ ExcessSolarAvailable_kW** (Col L): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=MAX( ($F2 - $G2) - $D2, 0 )`
- **⚠️ SoC_kWh** (Col M): Mixed formulas (102) and hardcoded values (2) in calculation column
  - Sample formula: `=MAX(
  0,
  MIN(
    Usable_BESS_Capacity,
    $M2 + $T2*Charge_discharge_efficiency - $W2/Charge_discharge_efficiency
  )
)`
- **⚠️ Delta** (Col N): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=M3-M2`
- **⚠️ Headroom_kWh** (Col O): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=MAX(0, Usable_BESS_Capacity - M2)`
- **⚠️ ChargeLimit_kWh** (Col P): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=MIN(Total_BESS_Power_Output*StepHours, O2/Charge_discharge_efficiency)`
- **⚠️ PVCharged_kWh** (Col Q): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=_xlfn.LET(
  _xlpm.dt, StepHours,
  _xlpm.cap_kW, $P2/_xlpm.dt,
  _xlpm.act_kW, $G2,
  _xlpm.rem_kW, MAX(_xlpm.cap_kW - _xlpm.act_kW, 0),
  _xlpm.exs_kW, MAX( ($F2 - _xlpm.act_kW) - $D2, 0 ),
  ( _xlpm.act_kW + MIN(_xlpm.exs_kW, _xlpm.rem_kW) ) * _xlpm.dt
)`
- **⚠️ Blance_Check** (Col R): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=F2-(I2+Q2*StepHours+Z2)`
- **⚠️ GridCharged_kWh** (Col S): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=_xlfn.LET(
  _xlpm.usable,  Usable_BESS_Capacity,
  _xlpm.capGrid, CapGrid,
  _xlpm.soc,     $M2,
  _xlpm.flag,    $K2,
  _xlpm.pv,      $Q2,
  _xlpm.lim,     $P2,
  _xlpm.rem,     MAX(_xlpm.lim - _xlpm.pv, 0),
  _xlpm.eta,     Charge_discharge_efficiency,
  IF(Does_BESS_System_include_?=0, 0,
     IF(_xlpm.flag=1,
        MIN(_xlpm.rem, MAX((_xlpm.capGrid - _xlpm.soc)/_xlpm.eta, 0)),
        IF(_xlpm.flag=2, _xlpm.rem, 0)
     )
  )
)`
- **⚠️ TotalBESSCharged_kWh** (Col T): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=Q2+S2`
- **⚠️ DischargeConditionFlag** (Col U): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=IF(
  Strategy_mode=1,
  IF(OR($J2=0,$H2>0),0,1),
  IF(
    Strategy_mode=2,
    IF(
      AND($E2="P", $AM2 >= PeakShave_DeepStartHour),
      3,
      IF($J2=1, 2, 0)
    ),
    0
  )
)`
- **⚠️ DischargeEnergy_kWh** (Col W): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=V2*StepHours`
- **⚠️ NetLoadAfterSolar+BESS** (Col X): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=D2-F2-V2`
- **⚠️ GridLoadAfterSolar+BESS_kW** (Col Y): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=IF(X2>0,X2+S2/StepHours,0)`
- **⚠️ PowerSurplus_kW** (Col Z): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=G2+L2-Q2/StepHours`
- **⚠️ CleanLoadServed_kWh** (Col AA): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=I2*StepHours+Q2*Charge_discharge_efficiency^2`
- **⚠️ NetGenForDPPA_kW** (Col AB): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=F2-Q2/StepHours+V2`
- **⚠️ NetCleanEnergyUsed_kWh** (Col AF): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=I2*StepHours+W2-S2`
- **⚠️ CombinrSystemSaving** (Col AG): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=AC2-AD2`
- **⚠️ BESSSaving** (Col AH): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=AG2-AE2`
- **⚠️ GridLoadafterSolar_kW** (Col AI): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=ABS(MIN(H2,0))`
- **⚠️ DemandTarget_kW** (Col AK): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=_xlfn.LET(
  _xlpm.ts, $A2,
  _xlpm.mKey, MONTH(_xlpm.ts),
  _xlfn.XLOOKUP(
    _xlpm.mKey,
    DemandTargetTbl[Month],
    DemandTargetTbl[Demand_Target_kW]
  )
)`
- **⚠️ Date** (Col AL): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=DAY(A2)`
- **⚠️ Hours** (Col AM): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=HOUR($A2)+MINUTE($A2)/60`
- **⚠️ Month** (Col AN): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=MONTH(A2)`

---

## Sheet: Helper

### Purpose
General Calculations

**Dimensions:** 46 rows × 14 columns

### Key Inputs (Hardcoded Values)

- **Month** (Col B): `Month`

### The Math (Formulas and English Translation)

No calculated columns detected in sampled rows.

### Cross-Sheet Dependencies

- References **$AN:$AN,Helper** from columns: C, E

### Anomalies / Flags

- **⚠️ BaselinePeak_kW** (Col C): Mixed formulas (38) and hardcoded values (3) in calculation column
  - Sample formula: `=_xlfn.MAXIFS(Calc!$D:$D,Calc!$AN:$AN,Helper!B3)`
- **⚠️ Demand_Target_kW** (Col D): Mixed formulas (38) and hardcoded values (3) in calculation column
  - Sample formula: `=C3*(1-Demand_Reduction_Target)`
- **⚠️ Column E** (Col E): Mixed formulas (26) and hardcoded values (2) in calculation column
  - Sample formula: `=SUMIFS(Calc!$AC:$AC,Calc!$AN:$AN,Helper!B18)`
- **⚠️ Column F** (Col F): Mixed formulas (26) and hardcoded values (2) in calculation column
  - Sample formula: `=D18+E18`
- **⚠️ Column G** (Col G): Mixed formulas (26) and hardcoded values (2) in calculation column
  - Sample formula: `=_xlfn.MAXIFS(Calc!$AI:$AI,Calc!$AN:$AN,B18)`
- **⚠️ Column H** (Col H): Mixed formulas (13) and hardcoded values (1) in calculation column
  - Sample formula: `=G18*Cp_demand`
- **⚠️ Column I** (Col I): Mixed formulas (13) and hardcoded values (1) in calculation column
  - Sample formula: `=SUMIFS(Calc!$AJ:$AJ,Calc!$AN:$AN,B18)`
- **⚠️ Column J** (Col J): Mixed formulas (13) and hardcoded values (1) in calculation column
  - Sample formula: `=H18+I18`
- **⚠️ Column K** (Col K): Mixed formulas (13) and hardcoded values (1) in calculation column
  - Sample formula: `=_xlfn.MAXIFS(Calc!$Y:$Y,Calc!$AN:$AN,B18)`
- **⚠️ Column L** (Col L): Mixed formulas (13) and hardcoded values (1) in calculation column
  - Sample formula: `=K18*Cp_demand`
- **⚠️ Column M** (Col M): Mixed formulas (13) and hardcoded values (1) in calculation column
  - Sample formula: `=SUMIFS(Calc!$AD:$AD,Calc!$AN:$AN,B18)`
- **⚠️ Column N** (Col N): Mixed formulas (13) and hardcoded values (1) in calculation column
  - Sample formula: `=L18+M18`

---

## Sheet: Other Input

### Purpose
Model Inputs / Assumptions

**Dimensions:** 23 rows × 6 columns

### Key Inputs (Hardcoded Values)

- **MRA Build-up Assumption** (Col A): `MRA Build-up Assumption`
- **Year** (Col B): `Year`
- **Pct.** (Col C): `Pct.`
- **Column D** (Col D): `22kV-2-component`
- **Column E** (Col E): `110kV-1-component`
- **Column F** (Col F): `22kV-1-component`

### The Math (Formulas and English Translation)

No calculated columns detected in sampled rows.

### Anomalies / Flags

No anomalies detected.

---

## Sheet: Loss

### Purpose
Solar Generation Model

**Dimensions:** 27 rows × 6 columns

### Key Inputs (Hardcoded Values)

- **Loss Table** (Col A): `Loss Table `
- **Battery's Loss** (Col B): `Battery's Loss`
- **PV Loss** (Col D): `PV Loss`

### The Math (Formulas and English Translation)

No calculated columns detected in sampled rows.

### Anomalies / Flags

- **⚠️ Battery** (Col C): Mixed formulas (24) and hardcoded values (2) in calculation column
  - Sample formula: `=C3-B4`
- **⚠️ PV** (Col E): Mixed formulas (24) and hardcoded values (2) in calculation column
  - Sample formula: `=E3-D4`
- **⚠️ Battery wt Replacement** (Col F): Mixed formulas (24) and hardcoded values (3) in calculation column
  - Sample formula: `=IF(MOD(A4,$F$1)=0,$C$4,F3*(1-B4))`

---

## Sheet: DPPA

### Purpose
Hourly Dispatch / Time Series Simulation

**Dimensions:** 8761 rows × 23 columns

### Key Inputs (Hardcoded Values)
No significant hardcoded inputs detected.

### Time Series Data

- **DateTime** (Col A): ~8761 rows of data
- **Load** (Col B): ~8761 rows of data
- **FMP** (Col C): ~8761 rows of data
- **CFMP** (Col D): ~8761 rows of data
- **C_BL** (Col N): ~8761 rows of data
- **BAU_Expense** (Col R): ~8761 rows of data

### The Math (Formulas and English Translation)

No calculated columns detected in sampled rows.

### Anomalies / Flags

- **⚠️ TimePeriodFlag** (Col E): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=_xlfn.XLOOKUP($A2, Calc!$A$2:$A$8761, Calc!$E$2:$E$8761, 0, 0, 2)`
- **⚠️ NetGeneration_Qmq** (Col F): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=IF(Does_model_is_actived?=1,
   _xlfn.XLOOKUP($A2, Calc!$A$2:$A$8761, Calc!$AB$2:$AB$8761, 0, 0, 2),
   0
)`
- **⚠️ Rg** (Col G): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=F2*C2`
- **⚠️ DeliveredREGen_Qm** (Col H): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=F2/(k_factor*Kpp)*Delta`
- **⚠️ Q_Khc** (Col I): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=MIN(B2,H2)`
- **⚠️ CDN** (Col J): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=I2*D2*Kpp`
- **⚠️ CCL** (Col K): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=I2*PCL`
- **⚠️ C_DPPA** (Col L): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=I2*CDPPAdv`
- **⚠️ Q_BL** (Col M): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=B2-I2`
- **⚠️ C_KH** (Col O): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=J2+K2+L2+N2`
- **⚠️ R_CFD** (Col P): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=I2*(Strike_Price-C2)`
- **⚠️ R_total** (Col Q): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=G2+P2`
- **⚠️ PriceSpread_Adj** (Col S): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=D2*Kpp-C2`
- **⚠️ PriceSpreadSettlement** (Col T): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=I2*S2`
- **⚠️ Surplus** (Col U): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=H2-I2`
- **⚠️ SurplusMarketRevenue** (Col V): Mixed formulas (103) and hardcoded values (1) in calculation column
  - Sample formula: `=U2*C2`

---

## Sheet: Measures

### Purpose
Financial Cash Flow Projection

**Dimensions:** 74 rows × 11 columns

### Key Inputs (Hardcoded Values)

- **Calculation Support** (Col C): `Calculation Support`
- **DPPA Calculation Support** (Col F): `DPPA Calculation Support`
- **Scenario comparison - Total Revenue by year** (Col J): `Scenario comparison - Total Revenue by year`

### The Math (Formulas and English Translation)

No calculated columns detected in sampled rows.

### Cross-Sheet Dependencies

- References **=Helper** from columns: D
- References **=Financial** from columns: K

### Anomalies / Flags

- **⚠️ Value** (Col D): Mixed formulas (41) and hardcoded values (4) in calculation column
  - Sample formula: `=Actual_installation_capacity/Simulation_capacity`
- **⚠️ Value** (Col G): Mixed formulas (32) and hardcoded values (9) in calculation column
  - Sample formula: `=IF(DPPA_Connection_Voltage_Level=110, Assumption!$Q$48, Assumption!$Q$47)`
- **⚠️ First year Revenue (US$)** (Col K): Mixed formulas (4) and hardcoded values (1) in calculation column
  - Sample formula: `=Financial!L68`

---

## Sheet: Lifetime

### Purpose
General Calculations

**Dimensions:** 26 rows × 26 columns

### Key Inputs (Hardcoded Values)

- **Year** (Col A): `Year`

### The Math (Formulas and English Translation)

No calculated columns detected in sampled rows.

### Anomalies / Flags

- **⚠️ Column B** (Col B): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(B$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column C** (Col C): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(C$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column D** (Col D): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(D$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column E** (Col E): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(E$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column F** (Col F): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(F$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column G** (Col G): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(G$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column H** (Col H): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(H$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column I** (Col I): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(I$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column J** (Col J): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(J$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column K** (Col K): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(K$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column L** (Col L): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(L$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column M** (Col M): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(M$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column N** (Col N): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(N$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column O** (Col O): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(O$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column P** (Col P): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(P$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column Q** (Col Q): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(Q$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column R** (Col R): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(R$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column S** (Col S): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(S$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column T** (Col T): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(T$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column U** (Col U): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(U$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column V** (Col V): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(V$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column W** (Col W): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(W$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column X** (Col X): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(X$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column Y** (Col Y): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(Y$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`
- **⚠️ Column Z** (Col Z): Mixed formulas (24) and hardcoded values (1) in calculation column
  - Sample formula: `=Total_Solar_Generation*_xlfn.XLOOKUP(Z$1,Loss!$A$3:$A$27,Loss!$E$3:$E$27,0,0)/1000`

---

## Sheet: Financial

### Purpose
General Calculations

**Dimensions:** 198 rows × 37 columns

### Key Inputs (Hardcoded Values)

- **Project Financial Model** (Col B): `Project Financial Model`
- **Model Timeline & Flangs** (Col C): `Model Timeline & Flangs`

### Time Series Data

- **Year** (Col D): ~198 rows of data
- **Column E** (Col E): ~198 rows of data

### The Math (Formulas and English Translation)

#### Column J: Column J

- **Formula:** `=SUM(K9:AJ9)`
- **English:** Sums values → Sample result: `1`

#### Column M: Column M

- **Formula:** `=YEAR(M6)`
- **English:** Formula-based calculation → Sample result: `2027`

#### Column N: Column N

- **Formula:** `=YEAR(N6)`
- **English:** Formula-based calculation → Sample result: `2028`

#### Column O: Column O

- **Formula:** `=YEAR(O6)`
- **English:** Formula-based calculation → Sample result: `2029`

#### Column P: Column P

- **Formula:** `=YEAR(P6)`
- **English:** Formula-based calculation → Sample result: `2030`

#### Column Q: Column Q

- **Formula:** `=YEAR(Q6)`
- **English:** Formula-based calculation → Sample result: `2031`

#### Column R: Column R

- **Formula:** `=YEAR(R6)`
- **English:** Formula-based calculation → Sample result: `2032`

#### Column S: Column S

- **Formula:** `=YEAR(S6)`
- **English:** Formula-based calculation → Sample result: `2033`

#### Column T: Column T

- **Formula:** `=YEAR(T6)`
- **English:** Formula-based calculation → Sample result: `2034`

#### Column U: Column U

- **Formula:** `=YEAR(U6)`
- **English:** Formula-based calculation → Sample result: `2035`

#### Column V: Column V

- **Formula:** `=YEAR(V6)`
- **English:** Formula-based calculation → Sample result: `2036`

#### Column W: Column W

- **Formula:** `=YEAR(W6)`
- **English:** Formula-based calculation → Sample result: `2037`

#### Column X: Column X

- **Formula:** `=YEAR(X6)`
- **English:** Formula-based calculation → Sample result: `2038`

#### Column Y: Column Y

- **Formula:** `=YEAR(Y6)`
- **English:** Formula-based calculation → Sample result: `2039`

#### Column Z: Column Z

- **Formula:** `=YEAR(Z6)`
- **English:** Formula-based calculation → Sample result: `2040`

#### Column AA: Column AA

- **Formula:** `=YEAR(AA6)`
- **English:** Formula-based calculation → Sample result: `2041`

#### Column AB: Column AB

- **Formula:** `=YEAR(AB6)`
- **English:** Formula-based calculation → Sample result: `2042`

#### Column AC: Column AC

- **Formula:** `=YEAR(AC6)`
- **English:** Formula-based calculation → Sample result: `2043`

#### Column AD: Column AD

- **Formula:** `=YEAR(AD6)`
- **English:** Formula-based calculation → Sample result: `2044`

#### Column AE: Column AE

- **Formula:** `=YEAR(AE6)`
- **English:** Formula-based calculation → Sample result: `2045`

#### Column AF: Column AF

- **Formula:** `=YEAR(AF6)`
- **English:** Formula-based calculation → Sample result: `2046`

#### Column AG: Column AG

- **Formula:** `=YEAR(AG6)`
- **English:** Formula-based calculation → Sample result: `2047`

#### Column AH: Column AH

- **Formula:** `=YEAR(AH6)`
- **English:** Formula-based calculation → Sample result: `2048`

#### Column AI: Column AI

- **Formula:** `=YEAR(AI6)`
- **English:** Formula-based calculation → Sample result: `2049`

#### Column AJ: Column AJ

- **Formula:** `=YEAR(AJ6)`
- **English:** Formula-based calculation → Sample result: `2050`

### Financial Calculations (IRR, NPV, Debt)

- **G123**: `=XIRR(K121:AJ121,$K$6:$AJ$6)`
  - **Result:** `0.050735542178153986`
  - **Type:** IRR Calculation
- **G136**: `=XIRR(K134:AJ134,$K$6:$AJ$6)`
  - **Result:** `0.04637605249881745`
  - **Type:** IRR Calculation
- **G189**: `=XIRR(K187:AJ187,$K$6:$AJ$6)`
  - **Result:** `0.08833179771900176`
  - **Type:** IRR Calculation
- **G193**: `=XNPV(G192,K187:AJ187,K6:AJ6)`
  - **Result:** `-2653309.3660635054`
  - **Type:** NPV Calculation

### Cross-Sheet Dependencies

- References **=Assumption** from columns: G, H
- References **=Measures** from columns: H
- References **=L10*Measures** from columns: L

### Anomalies / Flags

- **⚠️ Column G** (Col G): Mixed formulas (17) and hardcoded values (8) in calculation column
  - Sample formula: `=COD_Date`
- **⚠️ Column H** (Col H): Mixed formulas (16) and hardcoded values (7) in calculation column
  - Sample formula: `=Financial_Close`
- **⚠️ Column K** (Col K): Mixed formulas (20) and hardcoded values (1) in calculation column
  - Sample formula: `=YEAR(K6)`
- **⚠️ Column L** (Col L): Mixed formulas (66) and hardcoded values (2) in calculation column
  - Sample formula: `=YEAR(L6)`

---

## Sheet: Output

### Purpose
Debt / Financing Schedule

**Dimensions:** 123 rows × 13 columns

### Key Inputs (Hardcoded Values)

- **Project Summary** (Col B): `Project Summary`
- **Column C** (Col C): `Power`
- **Column D** (Col D): `MWp`
- **Table Financing (Debt & Equity)** (Col I): `Table Financing (Debt & Equity)`
- **Column J** (Col J): `PV EPC (full in place)`

### The Math (Formulas and English Translation)

No calculated columns detected in sampled rows.

### Cross-Sheet Dependencies

- References **-Financial** from columns: E
- References **=Financial** from columns: E, K, L
- References **=(Financial** from columns: E
- References **=Assumption** from columns: E, L

### Anomalies / Flags

- **⚠️ Value** (Col E): Mixed formulas (28) and hardcoded values (1) in calculation column
  - Sample formula: `=Actual_installation_capacity/1000`
- **⚠️ Column K** (Col K): Mixed formulas (8) and hardcoded values (15) in calculation column
  - Sample formula: `=E26`
- **⚠️ Value** (Col L): Mixed formulas (22) and hardcoded values (2) in calculation column
  - Sample formula: `=E25`

### Formatting Notes

- **Merged cell regions:** 3 found (decorative/headers)

---

## Data Flow Summary

### Sheet Interdependencies

- **Helper** depends on: $AN:$AN,Helper
- **Measures** depends on: =Financial, =Helper
- **Financial** depends on: =L10*Measures, =Measures, =Assumption
- **Output** depends on: -Financial, =Financial, =Assumption, =(Financial

---

*End of Analysis Report*